project: security-test

backends:
    test:
        type: adhoc
        warn-timeout: 1m
        kill-timeout: 2m
        allocate: |
            if [ ! -f test.file ]; then
                touch test.file
                echo "Allocating ad-hoc $SPREAD_SYSTEM"
                echo '' > /etc/sudoers.d/99-spread-users
            fi
            ADDRESS localhost:22
        discard: |
            echo "Discarding ad-hoc $SPREAD_SYSTEM"
        systems:
            - ubuntu-core-16-64:
                  username: external
                  password: ubuntu

path: /home/adhoc

restore:
    rm -rf /home/adhoc

suites:
    checks/: 
        summary: Verification tasks.

